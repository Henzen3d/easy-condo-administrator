const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/dbUtils-YHBIwV5j.js","assets/index-PF3D36V0.js","assets/index-BhASDYTj.css"])))=>i.map(i=>d[i]);
import{c as pe,r as o,s as x,j as e,B as Ke,U as Xe,S as Ye,I as U,a as O,R as G,D as fe,b as je,E as ge,d as be,e as I,T as ve,_ as Ze}from"./index-PF3D36V0.js";import{T as ce,a as ue,b as E,c as C,d as me,e as p,P as Ne}from"./table-Pv-7lEPL.js";import{D as we,a as Ce,b as ke,c as ye,d as Ue,S as X,e as Y,f as Z,g as ee,h as S,i as Ee}from"./select-BUw1FKH9.js";import{A as es,a as ss,b as as,c as rs,d as os,e as ns,f as is,g as ts}from"./alert-dialog-BY15mkZN.js";import{T as ls,a as ds,b as he,c as xe,L as k}from"./tabs-DTHgOjkY.js";import{u as cs}from"./use-toast-DSwJ8fSR.js";import{C as us}from"./circle-plus-B-ZudBTP.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=pe("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ms=pe("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),Se=G.memo(({units:i,formData:u,setFormData:c})=>{const v=o.useCallback(m=>{const[A,q]=m.split("|");c(y=>({...y,residentUnit:A,residentBlock:q}))},[c]),f=o.useMemo(()=>u.residentUnit&&u.residentBlock?`${u.residentUnit}|${u.residentBlock}`:"",[u.residentUnit,u.residentBlock]);return e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{children:"Unidade"}),e.jsxs(X,{value:f,onValueChange:v,children:[e.jsx(Y,{className:"w-full",children:e.jsx(Z,{placeholder:"Selecione a unidade"})}),e.jsx(ee,{children:i.map(m=>e.jsxs(S,{value:`${m.number}|${m.block}`,children:["Unidade ",m.number," - Bloco ",m.block]},m.id))})]})]})});Se.displayName="UnitSelect";const hs=G.memo(({unit:i,onEdit:u,onDelete:c,onAddResident:v})=>e.jsxs(E,{children:[e.jsx(p,{className:"font-medium",children:i.number}),e.jsx(p,{children:i.block}),e.jsx(p,{children:i.owner||"Não atribuído"}),e.jsx(p,{children:i.residents}),e.jsx(p,{children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${i.status==="occupied"?"bg-green-100 text-green-800":i.status==="vacant"?"bg-amber-100 text-amber-800":"bg-gray-100 text-gray-800"}`,children:i.status==="occupied"?"Ocupado":i.status==="vacant"?"Vago":i.status})}),e.jsx(p,{children:e.jsxs(fe,{children:[e.jsx(je,{asChild:!0,children:e.jsx(O,{variant:"ghost",className:"h-8 w-8 p-0",children:e.jsx(ge,{className:"h-4 w-4"})})}),e.jsxs(be,{align:"end",children:[e.jsxs(I,{onClick:()=>u(i),children:[e.jsx(Ne,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Editar"})]}),e.jsxs(I,{onClick:()=>v(i),children:[e.jsx(ms,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Adicionar Morador"})]}),e.jsxs(I,{onClick:()=>c(i.id),className:"text-red-600",children:[e.jsx(ve,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Excluir"})]})]})]})})]})),xs=G.memo(({resident:i,onEdit:u,onDelete:c})=>e.jsxs(E,{children:[e.jsx(p,{className:"font-medium",children:i.name}),e.jsx(p,{children:i.email}),e.jsx(p,{children:i.phone}),e.jsx(p,{children:`${i.unit_block} - ${i.unit_number}`}),e.jsx(p,{children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${i.role==="owner"?"bg-blue-100 text-blue-800":i.role==="tenant"?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"}`,children:i.role==="owner"?"Proprietário":i.role==="tenant"?"Inquilino":i.role})}),e.jsx(p,{children:e.jsxs(fe,{children:[e.jsx(je,{asChild:!0,children:e.jsx(O,{variant:"ghost",className:"h-8 w-8 p-0",children:e.jsx(ge,{className:"h-4 w-4"})})}),e.jsxs(be,{align:"end",children:[e.jsxs(I,{onClick:()=>u(i),children:[e.jsx(Ne,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Editar"})]}),e.jsxs(I,{onClick:()=>c(i),className:"text-red-600",children:[e.jsx(ve,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Excluir"})]})]})]})})]})),Ae=G.memo(({open:i,onOpenChange:u,units:c,formData:v,setFormData:f,isAddingResident:m,loading:A,handleAddResident:q,handleUpdateResident:y})=>{const t=(h,V)=>{f(D=>({...D,[h]:V}))};return e.jsx(we,{open:i,onOpenChange:u,children:e.jsxs(Ce,{children:[e.jsxs(ke,{children:[e.jsx(ye,{children:m?"Adicionar Novo Morador":"Editar Morador"}),e.jsx(Ue,{children:"Preencha os dados do morador."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"resident-name",children:"Nome"}),e.jsx(U,{id:"resident-name",placeholder:"Nome completo",value:v.residentName,onChange:h=>t("residentName",h.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"resident-email",children:"Email"}),e.jsx(U,{id:"resident-email",type:"email",placeholder:"email@exemplo.com",value:v.residentEmail,onChange:h=>t("residentEmail",h.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"resident-phone",children:"Telefone"}),e.jsx(U,{id:"resident-phone",placeholder:"(00) 00000-0000",value:v.residentPhone,onChange:h=>t("residentPhone",h.target.value)})]}),e.jsx(Se,{units:c,formData:v,setFormData:f}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"resident-role",children:"Função"}),e.jsxs(X,{value:v.residentRole,onValueChange:h=>t("residentRole",h),children:[e.jsx(Y,{id:"resident-role",children:e.jsx(Z,{placeholder:"Selecione a função"})}),e.jsxs(ee,{children:[e.jsx(S,{value:"owner",children:"Proprietário"}),e.jsx(S,{value:"tenant",children:"Inquilino"}),e.jsx(S,{value:"resident",children:"Morador"}),e.jsx(S,{value:"visitor",children:"Visitante"})]})]})]})]}),e.jsxs(Ee,{children:[e.jsx(O,{variant:"outline",onClick:()=>u(!1),children:"Cancelar"}),e.jsxs(O,{type:"submit",disabled:A,onClick:h=>{h.preventDefault(),m?q():y()},children:[A&&e.jsx(Q,{className:"mr-2 h-4 w-4 animate-spin"}),m?"Adicionar":"Atualizar"]})]})]})})});Ae.displayName="ResidentDialog";function ws(){const[i,u]=o.useState("units"),[c,v]=o.useState(""),[f,m]=o.useState([]),[A,q]=o.useState([]),[y,t]=o.useState(!0),[h,V]=o.useState(null),[D,H]=o.useState(null),[W,se]=o.useState(!0),[Oe,K]=o.useState(!0),[a,b]=o.useState({unitNumber:"",unitBlock:"",unitOwner:"",unitOwnerEmail:"",unitOwnerPhone:"",unitStatus:"occupied",residentName:"",residentEmail:"",residentPhone:"",residentUnit:"",residentBlock:"",residentRole:"resident"}),[ae,R]=o.useState(!1),[De,T]=o.useState(!1);o.useState(!1),o.useState(!1);const[Re,F]=o.useState(!1),[B,re]=o.useState(null),[J,oe]=o.useState(null),[ne,ie]=o.useState(!1),[te,Te]=o.useState(!1),{toast:l}=cs(),P=o.useCallback(()=>{b(s=>({...s,unitNumber:"",unitBlock:"",unitOwner:"",unitOwnerEmail:"",unitOwnerPhone:"",unitStatus:"occupied"}))},[]),L=o.useCallback(()=>{b(s=>({...s,residentName:"",residentEmail:"",residentPhone:"",residentUnit:"",residentBlock:"",residentRole:"resident"}))},[]),_=o.useCallback(async(s,r)=>{const{data:n}=await x.from("units").select("id").eq("number",s.trim()).eq("block",r.trim());return n?n.length>0:!1},[]),Be=o.useCallback(async s=>{const r=s.target.value;b(n=>({...n,unitNumber:r}));try{if(r){const n=a.unitBlock.trim()||"",d=await _(r,n);ie(d),d&&l({title:"Atenção",description:`A unidade ${r}${n?` do bloco ${n}`:""} já está cadastrada.`,variant:"destructive"})}}catch(n){console.error("Erro ao verificar unidade:",n)}},[a.unitBlock,_,l]),Pe=o.useCallback(async s=>{const r=s.target.value;b(n=>({...n,unitBlock:r}));try{if(a.unitNumber){const n=r.trim()||"",d=await _(a.unitNumber,n);ie(d),d&&l({title:"Atenção",description:`A unidade ${a.unitNumber}${n?` do bloco ${n}`:""} já está cadastrada.`,variant:"destructive"})}}catch(n){console.error("Erro ao verificar unidade:",n)}},[a.unitNumber,_,l]),z=o.useCallback(async()=>{try{t(!0),console.log("Fetching units...");const{data:s,error:r}=await x.from("units").select("*");if(console.log("Units query response:",{data:s,error:r}),r)throw console.error("Error details:",JSON.stringify(r)),r;m(s||[])}catch(s){console.error("Error fetching units:",s),l({title:"Não foi possível carregar as unidades.",description:"Ocorreu um erro ao carregar as unidades.",variant:"destructive"})}finally{t(!1)}},[]),N=o.useCallback(async()=>{try{t(!0),console.log("Fetching units for residents...");const{data:s,error:r}=await x.from("units").select("id, number, block");if(console.log("Units for residents response:",{unitsData:s,unitsError:r}),r)throw console.error("Error details (units):",JSON.stringify(r)),r;console.log("Fetching residents...");const{data:n,error:d}=await x.from("residents").select("*");if(console.log("Residents query response:",{data:n,error:d}),d)throw console.error("Error details (residents):",JSON.stringify(d)),d;const j=(n==null?void 0:n.map(w=>{const g=s==null?void 0:s.find(M=>M.id===w.unit_id);return{...w,unit_number:(g==null?void 0:g.number)||"",unit_block:(g==null?void 0:g.block)||""}}))||[];q(j)}catch(s){console.error("Error fetching residents:",s),l({title:"Não foi possível carregar os moradores.",description:"Ocorreu um erro ao carregar os moradores.",variant:"destructive"})}finally{t(!1)}},[]),Le=o.useCallback(async()=>{var s,r;console.log("handleAddUnit chamado - iniciando processo de adição");try{if(t(!0),console.log("Loading definido como true"),console.log("Validando campos obrigatórios:",a),!a.unitNumber||!a.unitOwner){console.log("Campos obrigatórios não preenchidos"),l({title:"Campos obrigatórios",description:"Número da unidade e proprietário são campos obrigatórios.",variant:"destructive"}),t(!1);return}const n=a.unitBlock.trim()||"";console.log("Verificando se a unidade já existe, blockValue:",n);const d=await _(a.unitNumber,n);if(console.log("Unidade existe?",d),d){console.log("Unidade já existe no sistema"),l({title:"Unidade já cadastrada",description:`A unidade ${a.unitNumber}${n?` do bloco ${n}`:""} já está cadastrada.`,variant:"destructive"}),t(!1);return}const j={number:a.unitNumber.trim(),block:n,owner:a.unitOwner.trim(),residents:1,status:a.unitStatus};console.log("Dados da nova unidade preparados:",j),console.log("Enviando requisição para criar unidade no Supabase");const{data:w,error:g}=await x.from("units").insert([j]).select().single();if(console.log("Resposta do Supabase:",{unitData:w,unitError:g}),g){if(console.log("Erro ao inserir unidade:",g),g.code==="23505"){l({title:"Unidade já cadastrada",description:`A unidade ${a.unitNumber} do bloco ${a.unitBlock} já está cadastrada.`,variant:"destructive"}),t(!1);return}throw g}if(!w)throw console.log("Nenhum dado retornado após criar unidade"),new Error("Nenhum dado retornado após criar unidade");const M={name:a.unitOwner.trim(),email:((s=a.unitOwnerEmail)==null?void 0:s.trim())||null,phone:((r=a.unitOwnerPhone)==null?void 0:r.trim())||null,unit_id:w.id,role:"owner",status:"active"};console.log("Dados do novo morador preparados:",M),console.log("Enviando requisição para criar morador no Supabase");const{error:$}=await x.from("residents").insert([M]);if(console.log("Resposta para criação de morador:",{residentError:$}),$)throw console.log("Erro ao inserir morador, fazendo rollback da unidade"),await x.from("units").delete().eq("id",w.id),$;console.log("Atualizando lista de unidades local"),m(We=>[...We,w]),console.log("Buscando lista atualizada de moradores"),await N(),console.log("Resetando formulário de unidades"),P(),console.log("Fechando dialog de unidade"),R(!1),console.log("Exibindo mensagem de sucesso"),l({title:"Unidade e proprietário cadastrados com sucesso!",description:"A unidade e o proprietário foram cadastrados com sucesso."})}catch(n){console.error("Erro ao adicionar unidade e proprietário:",n),l({title:"Não foi possível cadastrar a unidade e o proprietário.",description:"Ocorreu um erro ao cadastrar a unidade e o proprietário.",variant:"destructive"})}finally{console.log("Finalizando função handleAddUnit - definindo loading como false"),t(!1)}},[a,_,N,P,l]),_e=o.useCallback(async()=>{if(h)try{t(!0);const s={number:a.unitNumber,block:a.unitBlock,owner:a.unitOwner,status:a.unitStatus},{error:r}=await x.from("units").update(s).eq("id",h.id);if(r)throw r;m(n=>n.map(d=>d.id===h.id?{...d,...s}:d)),P(),V(null),R(!1),l({title:"Unidade atualizada com sucesso!",description:"A unidade foi atualizada com sucesso."})}catch(s){console.error("Erro ao atualizar unidade:",s),l({title:"Não foi possível atualizar a unidade.",description:"Ocorreu um erro ao atualizar a unidade.",variant:"destructive"})}finally{t(!1)}},[a,h,P]),ze=o.useCallback(s=>{re(s),F(!0)},[]),Me=o.useCallback(async()=>{if(B)try{t(!0);const{error:s}=await x.from("units").delete().eq("id",B);if(s)throw s;m(r=>r.filter(n=>n.id!==B)),l({title:"Unidade excluída com sucesso!",description:"A unidade foi excluída com sucesso."}),N()}catch(s){console.error("Erro ao excluir unidade:",s),l({title:"Não foi possível excluir a unidade.",description:"Ocorreu um erro ao excluir a unidade.",variant:"destructive"})}finally{t(!1),re(null),F(!1)}},[B,N]),qe=o.useCallback(async()=>{try{t(!0);const s=f.find(j=>j.number===a.residentUnit&&j.block===a.residentBlock);if(!s){l({title:"Unidade não encontrada",description:"Unidade não encontrada. Verifique o número e bloco.",variant:"destructive"}),t(!1);return}const r={name:a.residentName,email:a.residentEmail,phone:a.residentPhone,unit_id:s.id,role:a.residentRole,status:"active"},{data:n,error:d}=await x.from("residents").insert(r).select();if(d)throw d;await x.from("units").update({residents:s.residents+1}).eq("id",s.id),z(),N(),L(),T(!1),l({title:"Morador adicionado com sucesso!",description:"O morador foi adicionado com sucesso."})}catch(s){console.error("Erro ao adicionar morador:",s),l({title:"Não foi possível adicionar o morador.",description:"Ocorreu um erro ao adicionar o morador.",variant:"destructive"})}finally{t(!1)}},[a,f,z,N,L]),Ve=o.useCallback(async()=>{if(D)try{t(!0);const s=f.find(j=>j.number===a.residentUnit&&j.block===a.residentBlock);if(!s){l({title:"Unidade não encontrada",description:"Unidade não encontrada. Verifique o número e bloco.",variant:"destructive"});return}const r=D.unit_id,n={name:a.residentName,email:a.residentEmail,phone:a.residentPhone,unit_id:s.id,role:a.residentRole},d=[];if(d.push(x.from("residents").update(n).eq("id",D.id)),r!==s.id){const j=f.find(w=>w.id===r);j&&d.push(x.from("units").update({residents:Math.max(0,j.residents-1)}).eq("id",r)),d.push(x.from("units").update({residents:s.residents+1}).eq("id",s.id))}await Promise.all(d),await Promise.all([z(),N()]),L(),H(null),T(!1),l({title:"Morador atualizado com sucesso!",description:"O morador foi atualizado com sucesso."})}catch(s){console.error("Erro ao atualizar morador:",s),l({title:"Não foi possível atualizar o morador.",description:"Ocorreu um erro ao atualizar o morador.",variant:"destructive"})}finally{t(!1)}},[a,f,D,z,N,L]),Fe=o.useCallback(s=>{oe(s),F(!0)},[]),$e=o.useCallback(async()=>{if(J)try{t(!0);const{error:s}=await x.from("residents").delete().eq("id",J.id);if(s)throw s;const r=f.find(n=>n.id===J.unit_id);r&&await x.from("units").update({residents:Math.max(0,r.residents-1)}).eq("id",r.id),z(),N(),l({title:"Morador excluído com sucesso!",description:"O morador foi excluído com sucesso."})}catch(s){console.error("Erro ao excluir morador:",s),l({title:"Não foi possível excluir o morador.",description:"Ocorreu um erro ao excluir o morador.",variant:"destructive"})}finally{t(!1),oe(null),F(!1)}},[J,N]),Ie=o.useCallback(s=>{V(s),se(!1),b(r=>({...r,unitNumber:s.number,unitBlock:s.block,unitOwner:s.owner,unitStatus:s.status})),R(!0)},[]),He=o.useCallback(s=>{H(s),K(!1),b(r=>({...r,residentName:s.name,residentEmail:s.email,residentPhone:s.phone,residentUnit:s.unit_number||"",residentBlock:s.unit_block||"",residentRole:s.role})),T(!0)},[]),Je=o.useCallback(s=>{u("residents"),K(!0),H(null),b(r=>({...r,residentUnit:s.number,residentBlock:s.block,residentName:"",residentEmail:"",residentPhone:"",residentRole:"resident"})),T(!0)},[]),Qe=o.useCallback(()=>{console.log("handleOpenAddUnitDialog chamado"),se(!0),V(null),P(),console.log("Antes de abrir o diálogo, openUnitDialog:",ae),R(!0),console.log("Depois de abrir o diálogo, openUnitDialog:",!0)},[P]),Ge=o.useCallback(()=>{K(!0),H(null),L(),T(!0)},[L]),le=o.useMemo(()=>f.filter(s=>s.number.toLowerCase().includes(c.toLowerCase())||s.block.toLowerCase().includes(c.toLowerCase())||s.owner.toLowerCase().includes(c.toLowerCase())),[f,c]),de=o.useMemo(()=>A.filter(s=>s.name.toLowerCase().includes(c.toLowerCase())||s.email.toLowerCase().includes(c.toLowerCase())||s.phone.toLowerCase().includes(c.toLowerCase())||s.unit_number&&s.unit_number.toLowerCase().includes(c.toLowerCase())||s.unit_block&&s.unit_block.toLowerCase().includes(c.toLowerCase())),[A,c]);return o.useEffect(()=>{(async()=>{try{t(!0),console.log("Verificando tabelas necessárias...");const{ensureUnitsTableExists:r,ensureResidentsTableExists:n,configureRLS:d}=await Ze(async()=>{const{ensureUnitsTableExists:g,ensureResidentsTableExists:M,configureRLS:$}=await import("./dbUtils-YHBIwV5j.js");return{ensureUnitsTableExists:g,ensureResidentsTableExists:M,configureRLS:$}},__vite__mapDeps([0,1,2]));if(!await r()){l({title:"Erro na estrutura de dados",description:"Não foi possível verificar ou criar a tabela de unidades.",variant:"destructive"}),t(!1);return}if(!await n()){l({title:"Erro na estrutura de dados",description:"Não foi possível verificar ou criar a tabela de moradores.",variant:"destructive"}),t(!1);return}await d(),console.log("Tabelas verificadas e configuradas com sucesso"),Te(!0)}catch(r){console.error("Erro ao verificar tabelas:",r),l({title:"Erro na estrutura de dados",description:"Ocorreu um erro ao verificar a estrutura do banco de dados.",variant:"destructive"})}finally{t(!1)}})()},[]),o.useEffect(()=>{te&&(z(),N())},[te]),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight animate-slide-in-top",children:"Unidades & Moradores"}),e.jsx("p",{className:"text-muted-foreground animate-slide-in-top animation-delay-100",children:"Gerencie as unidades do condomínio e seus respectivos moradores"})]}),e.jsxs(ls,{defaultValue:"units",className:"animate-fade-in",onValueChange:u,children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs(ds,{className:"w-full sm:w-auto",children:[e.jsxs(he,{value:"units",className:"flex-1 sm:flex-none flex items-center gap-2",children:[e.jsx(Ke,{size:16}),e.jsx("span",{children:"Unidades"})]}),e.jsxs(he,{value:"residents",className:"flex-1 sm:flex-none flex items-center gap-2",children:[e.jsx(Xe,{size:16}),e.jsx("span",{children:"Moradores"})]})]}),e.jsxs("div",{className:"flex flex-col w-full sm:flex-row sm:w-auto gap-2",children:[e.jsxs("div",{className:"relative flex-grow",children:[e.jsx(Ye,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(U,{type:"search",placeholder:i==="units"?"Buscar unidades...":"Buscar moradores...",className:"pl-9",value:c,onChange:s=>v(s.target.value)})]}),e.jsxs(O,{className:"flex items-center gap-2 w-full sm:w-auto",onClick:i==="units"?Qe:Ge,children:[e.jsx(us,{size:16}),e.jsx("span",{children:i==="units"?"Nova Unidade":"Novo Morador"})]})]})]}),e.jsx(xe,{value:"units",className:"space-y-4 animate-fade-in",children:e.jsx("div",{className:"rounded-md border overflow-x-auto",children:e.jsxs(ce,{children:[e.jsx(ue,{children:e.jsxs(E,{children:[e.jsx(C,{children:"Unidade"}),e.jsx(C,{className:"hidden sm:table-cell",children:"Bloco"}),e.jsx(C,{className:"hidden md:table-cell",children:"Proprietário"}),e.jsx(C,{className:"hidden sm:table-cell",children:"Moradores"}),e.jsx(C,{className:"hidden md:table-cell",children:"Status"}),e.jsx(C,{className:"w-[50px]",children:"Ações"})]})}),e.jsx(me,{children:y?e.jsx(E,{children:e.jsx(p,{colSpan:6,className:"h-24 text-center",children:e.jsx(Q,{className:"h-6 w-6 animate-spin mx-auto"})})}):le.length>0?le.map(s=>e.jsx(hs,{unit:s,onEdit:Ie,onDelete:ze,onAddResident:Je},s.id)):e.jsx(E,{children:e.jsx(p,{colSpan:6,className:"h-24 text-center",children:"Nenhuma unidade encontrada."})})})]})})}),e.jsx(xe,{value:"residents",className:"space-y-4 animate-fade-in",children:e.jsx("div",{className:"rounded-md border overflow-x-auto",children:e.jsxs(ce,{children:[e.jsx(ue,{children:e.jsxs(E,{children:[e.jsx(C,{children:"Nome"}),e.jsx(C,{className:"hidden md:table-cell",children:"Contato"}),e.jsx(C,{className:"hidden sm:table-cell",children:"Unidade"}),e.jsx(C,{className:"hidden md:table-cell",children:"Tipo"}),e.jsx(C,{className:"w-[50px]",children:"Ações"})]})}),e.jsx(me,{children:y?e.jsx(E,{children:e.jsx(p,{colSpan:5,className:"h-24 text-center",children:e.jsx(Q,{className:"h-6 w-6 animate-spin mx-auto"})})}):de.length>0?de.map(s=>e.jsx(xs,{resident:s,onEdit:He,onDelete:Fe},s.id)):e.jsx(E,{children:e.jsx(p,{colSpan:5,className:"h-24 text-center",children:"Nenhum morador encontrado."})})})]})})})]}),e.jsx(we,{open:ae,onOpenChange:s=>{console.log("Dialog onOpenChange chamado com valor:",s),R(s)},children:e.jsxs(Ce,{onInteractOutside:s=>{console.log("Dialog onInteractOutside chamado"),s.preventDefault()},children:[e.jsxs(ke,{children:[e.jsx(ye,{children:W?"Adicionar Nova Unidade":"Editar Unidade"}),e.jsx(Ue,{children:"Preencha os dados da unidade do condomínio."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"unit-number",children:"Número da Unidade *"}),e.jsx(U,{id:"unit-number",placeholder:"101",value:a.unitNumber,onChange:Be,className:ne?"border-red-500":""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Campo obrigatório"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"unit-block",children:"Bloco (opcional)"}),e.jsx(U,{id:"unit-block",placeholder:"A",value:a.unitBlock,onChange:Pe,className:a.unitNumber&&a.unitBlock&&ne?"border-red-500":""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Deixe em branco se não houver blocos"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"unit-owner",children:"Proprietário *"}),e.jsx(U,{id:"unit-owner",placeholder:"Nome do proprietário",value:a.unitOwner,onChange:s=>b({...a,unitOwner:s.target.value})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Campo obrigatório"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"unit-owner-email",children:"Email do Proprietário"}),e.jsx(U,{id:"unit-owner-email",type:"email",placeholder:"email@exemplo.com",value:a.unitOwnerEmail,onChange:s=>b({...a,unitOwnerEmail:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"unit-owner-phone",children:"Telefone"}),e.jsx(U,{id:"unit-owner-phone",placeholder:"(00) 00000-0000",value:a.unitOwnerPhone,onChange:s=>b({...a,unitOwnerPhone:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"unit-status",children:"Status"}),e.jsxs(X,{value:a.unitStatus,onValueChange:s=>b({...a,unitStatus:s}),children:[e.jsx(Y,{id:"unit-status",children:e.jsx(Z,{placeholder:"Selecione o status"})}),e.jsxs(ee,{children:[e.jsx(S,{value:"occupied",children:"Ocupado"}),e.jsx(S,{value:"vacant",children:"Vago"}),e.jsx(S,{value:"maintenance",children:"Em Manutenção"})]})]})]})]})]}),e.jsxs(Ee,{children:[e.jsx(O,{variant:"outline",onClick:s=>{console.log("Botão Cancelar clicado"),R(!1)},children:"Cancelar"}),e.jsxs(O,{type:"button",disabled:y,onClick:s=>{console.log("Botão Adicionar/Atualizar clicado manualmente"),s.preventDefault(),W?(console.log("Chamando handleAddUnit diretamente"),Le()):(console.log("Chamando handleUpdateUnit diretamente"),_e())},children:[y&&e.jsx(Q,{className:"mr-2 h-4 w-4 animate-spin"}),W?"Adicionar":"Atualizar"]})]})]})}),e.jsx(Ae,{open:De,onOpenChange:T,units:f,formData:a,setFormData:b,isAddingResident:Oe,loading:y,handleAddResident:qe,handleUpdateResident:Ve}),e.jsx(es,{open:Re,onOpenChange:F,children:e.jsxs(ss,{children:[e.jsxs(as,{children:[e.jsx(rs,{children:"Confirmar exclusão"}),e.jsx(os,{children:B?"Tem certeza que deseja excluir esta unidade? Esta ação não pode ser desfeita e também excluirá todos os moradores relacionados.":"Tem certeza que deseja excluir este morador? Esta ação não pode ser desfeita."})]}),e.jsxs(ns,{children:[e.jsx(is,{children:"Cancelar"}),e.jsx(ts,{className:"bg-red-600 hover:bg-red-700",onClick:()=>B?Me():$e(),children:"Excluir"})]})]})}),e.jsx("div",{className:"h-20"})]})}export{ws as default};
